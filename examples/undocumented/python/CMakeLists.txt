INCLUDE(PythonEnvironment)
GET_PYTHON_ENV()

FILE(GLOB PYTHON_EXAMPLES *.py)
FOREACH(EXAMPLE ${PYTHON_EXAMPLES})
	STRING(REGEX REPLACE ".*/(.*).py" "\\1" EXAMPLE_NAME ${EXAMPLE})
	add_test(NAME python-${EXAMPLE_NAME}
			WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
			COMMAND ${PYTHON_EXECUTABLE} ${EXAMPLE})
	set_property(TEST python-${EXAMPLE_NAME} PROPERTY
				ENVIRONMENT "${PYTHON_ENV_VARS}")
ENDFOREACH()
